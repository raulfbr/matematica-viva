# ════════════════════════════════════════════════════════════════════════════════
# WORKFLOW: CRIAR LIÇÃO PREMIUM
# ════════════════════════════════════════════════════════════════════════════════

id: criar_licao_premium
tipo: workflow
versao: "1.0"
coordenadora: charlotte_mason

descricao: |
  Workflow completo para criar lição de alta qualidade.
  CM coordena. Especialistas contribuem. QA valida.

# ════════════════════════════════════════════════════════════════════════════════
# FASES
# ════════════════════════════════════════════════════════════════════════════════

fases:
  - fase: 1
    nome: "PLANEJAMENTO"
    especialistas:
      - charlotte_mason
      - jerome_bruner
      - lev_vygotsky
    
    passos:
      - passo: 1
        acao: "Receber tema e consultar TGTB"
        responsavel: orchestrator
        fonte_tgtb: "curriculo/_SISTEMA/CURRICULOS_MESTRE/"
        arquivos_por_fase:
          sementes: "000_K_SEMENTES_CURRICULO_MESTRE.md"
          raizes_1: "001_1ANO_RAIZES-1_CURRICULO_MESTRE.md"
          raizes_2: "002_2ANO_RAIZES-2_CURRICULO_MESTRE.md"
        regra: "SEMPRE consultar o currículo mestre para obter tgtb_ref"
        
      - passo: 2
        acao: "Definir Ideia Viva"
        responsavel: charlotte_mason
        pergunta: "Qual verdade viva a criança vai descobrir?"
        
      - passo: 3
        acao: "Propor estrutura CPA"
        responsavel: jerome_bruner
        regras:
          - "Concreto ≥ 60%"
          - "Pictórico vetado para Sementes"
          - "Abstrato mínimo"
          
      - passo: 4
        acao: "Definir ZPD e scaffolding"
        responsavel: lev_vygotsky
        pergunta: "Qual andaime a criança precisa?"
        
      - passo: 5
        acao: "CM valida ou veta"
        responsavel: charlotte_mason
        poder: "Veto absoluto"
        
    output: "perd.yaml"  # Pedagogical Requirements Doc
    checkpoint: true  # Humano aprova antes de continuar

  - fase: 2
    nome: "DESENVOLVIMENTO"
    especialistas:
      - cs_lewis
      - jrr_tolkien
      - beatrix_potter
    
    passos:
      - passo: 6
        acao: "Escrever narrativa com guardião"
        responsavel: cs_lewis
        criterio: "Tom nobre, não condescendente"
        
      - passo: 7
        acao: "Validar consistência do Reino"
        responsavel: jrr_tolkien
        pergunta: "Há contradição com lições anteriores?"
        
      - passo: 8
        acao: "Validar estética visual"
        responsavel: beatrix_potter
        criterio: "Cores naturais, realismo caprichoso"
        
      - passo: 9
        acao: "CM revisa fluxo geral"
        responsavel: charlotte_mason
        
    output: "rascunho.yaml"
    checkpoint: true  # Matriarca valida tom

  - fase: 3
    nome: "VERIFICAÇÃO"
    especialistas:
      - makoto_fujimura
      - engenharia
      - maes_personas
    
    passos:
      - passo: 10
        acao: "QA Quíntupla"
        responsavel: engenharia
        checks:
          - "CM: 20 Princípios"
          - "CPA: Ordem correta"
          - "Tempo: ≤ 20 min"
          - "Guardião: Frases corretas"
          - "Template: Completo"
          
      - passo: 11
        acao: "Teste do Café da Manhã"
        responsavel: maes_personas
        pergunta: "Mãe exausta consegue em 5 min?"
        
      - passo: 12
        acao: "Kintsugi se necessário"
        responsavel: makoto_fujimura
        acao_kintsugi: "Transformar erros em ouro"
        
      - passo: 13
        acao: "Aprovação final"
        responsavel: charlotte_mason
        
    output: "licao_final.yaml"

# ════════════════════════════════════════════════════════════════════════════════
# OUTPUTS
# ════════════════════════════════════════════════════════════════════════════════

outputs:
  - "curriculo/01_SEMENTES/{numero}_{titulo}.yaml"
  - "site/sementes/{numero}.html" (via pipeline)

# ════════════════════════════════════════════════════════════════════════════════
# INVOCAÇÃO
# ════════════════════════════════════════════════════════════════════════════════

invocacao:
  comando: "/criar-licao [numero] [tema]"
  exemplo: "/criar-licao L002 Contagem até 5"
